(function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof module&&module.exports?module.exports=e():t.Tobi=e()})(this,function(){"use strict";var t=function(t){var e={},i=null,n=[],a=0,r=null,o=null,d=[],s=0,c={},u=!1,l=null,m=document.createElement("div");m.setAttribute("role","dialog"),m.setAttribute("aria-hidden","true"),m.classList.add("tobi-overlay"),document.getElementsByTagName("body")[0].appendChild(m);var b=document.createElement("div");b.classList.add("tobi-slider"),m.appendChild(b);var p=document.createElement("button");p.setAttribute("type","button"),p.setAttribute("aria-label","Previous"),m.appendChild(p);var g=document.createElement("button");g.setAttribute("type","button"),g.setAttribute("aria-label","Next"),m.appendChild(g);var f=document.createElement("button");f.setAttribute("type","button"),f.setAttribute("aria-label","Close"),m.appendChild(f);var v=document.createElement("div");v.classList.add("tobi-counter"),m.appendChild(v);var h={image:{checkSupport:function(t){return null!=t.href.match(/\.(png|jpg|tiff|tif|gif|bmp|webp|svg|ico)$/)},init:function(t,i){var n=document.createElement("img");if(n.style.opacity="0",t.getElementsByTagName("img")[0]&&t.getElementsByTagName("img")[0].alt?n.alt=t.getElementsByTagName("img")[0].alt:n.alt="",n.setAttribute("src",""),n.setAttribute("data-src",t.href),i.appendChild(n),i.setAttribute("data-type","image"),e.captions){var r=document.createElement("figcaption");r.style.opacity="0","self"===e.captionsSelector&&t.getAttribute(e.captionAttribute)?r.innerHTML=t.getAttribute(e.captionAttribute):"img"===e.captionsSelector&&t.getElementsByTagName("img")[0]&&t.getElementsByTagName("img")[0].getAttribute(e.captionAttribute)&&(r.innerHTML=t.getElementsByTagName("img")[0].getAttribute(e.captionAttribute)),r.innerHTML&&(r.id="tobi-figcaption-"+a,i.appendChild(r),n.setAttribute("aria-labelledby",r.id))}},onPreload:function(t){h.image.onLoad(t)},onLoad:function(t){var e=t.getElementsByTagName("img")[0];if(e.hasAttribute("data-src")){var i=t.getElementsByTagName("figcaption")[0],n=document.createElement("div");n.classList.add("tobi-loader"),t.appendChild(n),e.onload=function(){var n=t.querySelector(".tobi-loader");t.removeChild(n),e.style.opacity="1",i&&(i.style.opacity="1")},e.setAttribute("src",e.getAttribute("data-src")),e.removeAttribute("data-src")}},onLeave:function(t){}},youtube:{checkSupport:function(t){var e=M(t.href);return"www.youtube.com"===e},init:function(t,e){var i=document.createElement("iframe"),n=t.href;n.indexOf("?")===-1&&(n+="?param=false"),n+="&enablejsapi=1";var a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=1280;t.hasAttribute("data-width")&&(o=t.getAttribute("data-width")),o>a&&(o=a);var d=720;t.hasAttribute("data-height")&&(d=t.getAttribute("data-height")),d>r&&(d=r),i.setAttribute("width",o),i.setAttribute("height",d),i.setAttribute("frameborder","0"),i.setAttribute("allow","autoplay; encrypted-media"),i.setAttribute("allowfullscreen",""),i.style.opacity="0",i.setAttribute("src",""),i.setAttribute("data-src",n),e.appendChild(i),e.setAttribute("data-type","youtube")},onPreload:function(t){},onLoad:function(t){var e=t.getElementsByTagName("iframe")[0];e.style.opacity="1";var i=t.getElementsByTagName("figcaption")[0];i&&(i.style.opacity="1"),e.setAttribute("src",e.getAttribute("data-src"))},onLeave:function(t){var e=t.getElementsByTagName("iframe")[0];e.setAttribute("src","")}},iframe:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"iframe"!==t.getAttribute("data-type"))},init:function(t,e){var i=document.createElement("iframe"),n=t.href,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=1280;t.hasAttribute("data-width")&&(o=t.getAttribute("data-width")),o>a&&(o=a);var d=720;t.hasAttribute("data-height")&&(d=t.getAttribute("data-height")),d>r&&(d=r),i.setAttribute("width",o),i.setAttribute("height",d),i.setAttribute("frameborder","0"),i.style.opacity="0",i.setAttribute("src",""),i.setAttribute("data-src",n),e.appendChild(i),e.setAttribute("data-type","iframe")},onPreload:function(t){},onLoad:function(t){var e=t.getElementsByTagName("iframe")[0];e.style.opacity="1";var i=t.getElementsByTagName("figcaption")[0];i&&(i.style.opacity="1"),e.setAttribute("src",e.getAttribute("data-src"))},onLeave:function(t){var e=t.getElementsByTagName("iframe")[0];e.setAttribute("src","")}},html:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"html"!==t.getAttribute("data-type"))},init:function(t,e){var i=document.createElement("div");i.classList.add("tobi-html");var n=t.getAttribute("data-target"),a=document.querySelector(n);return void 0===a?void console.log("Ups, I can't find the target "+n+"."):(i.style.opacity="0",i.innerHTML=a.innerHTML,e.appendChild(i),void e.setAttribute("data-type","html"))},onPreload:function(t){},onLoad:function(t){var e=t.querySelector(".tobi-html");e.style.opacity="1";var i=t.getElementsByTagName("figcaption")[0];i&&(i.style.opacity="1")},onLeave:function(t){var e=t.querySelector("video");null!==e&&e.pause()}}},y=function(t){return e=N(t),i=B(),r=document.querySelectorAll(e.selector),(o=r.length)?void[].forEach.call(r,function(t){A(t)}):void console.log("Ups, I can't find the selector "+e.selector+".")},A=function(t){if(n.indexOf(t)===-1){if(n.push(t),t.classList.add("tobi"),e.zoom&&t.getElementsByTagName("img")[0]){var i=document.createElement("div");i.classList.add("tobi__zoom-icon"),i.innerHTML=e.zoomText,t.classList.add("tobi--zoom"),t.appendChild(i)}t.addEventListener("click",function(t){t.preventDefault(),L(n.indexOf(this))}),E(t)}},E=function(t){var i=null,n=null,r=null;i=document.createElement("div"),i.classList.add("tobi-slide"),n=document.createElement("div"),n.classList.add("tobi-figure-wrapper"),r=document.createElement("figure"),r.classList.add("tobi-figure");for(var s in h)if(h[s].checkSupport(t)===!0){h[s].init(t,r);break}n.appendChild(r),i.appendChild(n),b.appendChild(i),d.push(i),++a,!e.nav||1===o||"auto"===e.nav&&"ontouchstart"in window?(p.setAttribute("aria-hidden","true"),g.setAttribute("aria-hidden","true")):(p.setAttribute("aria-hidden","false"),g.setAttribute("aria-hidden","false"),p.innerHTML=e.navText[0],g.innerHTML=e.navText[1]),e.counter&&1!==o?v.setAttribute("aria-hidden","false"):v.setAttribute("aria-hidden","true"),e.close?f.innerHTML=e.closeText:f.setAttribute("aria-hidden","true"),e.draggable&&(b.style.cursor="-webkit-grab")},L=function(t){"false"!==m.getAttribute("aria-hidden")&&(e.scroll||(document.documentElement.classList.add("tobi--is-open"),document.body.classList.add("tobi--is-open")),l=document.activeElement,s=t,q(),G(),k(s),T(s+1),T(s-1),x(),H(),m.setAttribute("aria-hidden","false"),S())},w=function(){"true"!==m.getAttribute("aria-hidden")&&(e.scroll||(document.documentElement.classList.remove("tobi--is-open"),document.body.classList.remove("tobi--is-open")),J(),m.setAttribute("aria-hidden","true"),l.focus())},T=function(t,e,i){if(void 0!==d[t]){var n=d[t].querySelector("figure"),a=n.getAttribute("data-type");h[a].onPreload(n)}},k=function(t,e,i){if(void 0!==d[t]){var n=d[t].querySelector("figure"),a=n.getAttribute("data-type");h[a].onLoad(n)}},C=function(){for(var t=0;t<d.length;t++){var e=d[t].querySelector("figure"),i=e.getAttribute("data-type");h[i].onLeave(e)}},N=function(t){var e={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:["&lsaquo;","&rsaquo;"],close:!0,closeText:"&times;",counter:!0,keyboard:!0,zoom:!0,zoomText:"&plus;",docClose:!0,swipeClose:!0,scroll:!1,draggable:!0,threshold:20};return t&&Object.keys(t).forEach(function(i){e[i]=t[i]}),e},B=function(){var t=document.documentElement.style;return"string"==typeof t.transform?"transform":"WebkitTransform"},x=function(){var t=100*-s+"%";b.style[i]="translate3d("+t+", 0, 0)"},H=function(){v.innerHTML=s+1+"/"+o},S=function(t){e.nav?(p.disabled=!1,g.disabled=!1,s===o-1?g.disabled=!0:0===s&&(p.disabled=!0),t||g.disabled?t||!g.disabled||p.disabled?g.disabled||"right"!==t?g.disabled&&"right"===t&&!p.disabled?p.focus():p.disabled||"left"!==t?p.disabled&&"left"===t&&!g.disabled&&g.focus():p.focus():g.focus():p.focus():g.focus()):e.close&&f.focus()},X=function(){s!==d.length-1&&C(),s<o-1&&(s++,x(),H(),S("right"),k(s),T(s+1))},P=function(){s>0&&C(),s>0&&(s--,x(),H(),S("left"),k(s),T(s-1))},M=function(t){var e;return e=t.indexOf("//")>-1?t.split("/")[2]:t.split("/")[0],e=e.split(":")[0],e=e.split("?")[0]},q=function(){c={startX:0,endX:0,startY:0,endY:0}},Y=function(){var t=c.endX-c.startX,i=c.endY-c.startY,n=Math.abs(t),a=Math.abs(i);t>0&&n>e.threshold?P():t<0&&n>e.threshold?X():i<0&&a>e.threshold&&e.swipeClose&&w()},W=function(t){t.target===p?P():t.target===g?X():(t.target===f||t.target.classList.contains("tobi-figure-wrapper")&&!t.target.classList.contains("tobi-figure"))&&w(),t.stopPropagation()},z=function(t){switch(t.keyCode){case 37:P();break;case 39:X();break;case 27:w()}},O=function(t){t.stopPropagation(),u=!0,c.startX=t.touches[0].pageX,c.startY=t.touches[0].pageY},j=function(t){t.preventDefault(),t.stopPropagation(),u&&(c.endX=t.touches[0].pageX,c.endY=t.touches[0].pageY)},D=function(t){t.stopPropagation(),u=!1,c.endX&&Y(),q()},I=function(t){t.preventDefault(),t.stopPropagation(),u=!0,c.startX=t.pageX,b.style.cursor="-webkit-grabbing"},U=function(t){t.stopPropagation(),u=!1,b.style.cursor="-webkit-grab",c.endX&&Y(),q()},_=function(t){t.preventDefault(),u&&(c.endX=t.pageX,b.style.cursor="-webkit-grabbing")},$=function(t){u&&(u=!1,b.style.cursor="-webkit-grab",c.endX=t.pageX,Y(),q())},F=function(t){"false"!==m.getAttribute("aria-hidden")||m.contains(t.target)||(t.stopPropagation(),S())},G=function(){e.keyboard&&document.addEventListener("keydown",z),e.docClose&&m.addEventListener("click",W),p.addEventListener("click",W),g.addEventListener("click",W),f.addEventListener("click",W),e.draggable&&(m.addEventListener("touchstart",O),m.addEventListener("touchmove",j),m.addEventListener("touchend",D),m.addEventListener("mousedown",I),m.addEventListener("mouseup",U),m.addEventListener("mouseleave",$),m.addEventListener("mousemove",_)),document.addEventListener("focus",F,!0)},J=function(){e.keyboard&&document.removeEventListener("keydown",z),e.docClose&&m.removeEventListener("click",W),p.removeEventListener("click",W),g.removeEventListener("click",W),f.removeEventListener("click",W),e.draggable&&(m.removeEventListener("touchstart",O),m.removeEventListener("touchmove",j),m.removeEventListener("touchend",D),m.removeEventListener("mousedown",I),m.removeEventListener("mouseup",U),m.removeEventListener("mouseleave",$),m.removeEventListener("mousemove",_)),document.removeEventListener("focus",F),C()},K=function(t){A(t),o++};return y(t),{prev:P,next:X,open:L,close:w,add:K}};return t});