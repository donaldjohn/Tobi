(function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof module&&module.exports?module.exports=e():t.Tobi=e()})(this,function(){"use strict";var t=function(t){var e={},i=null,n=[],a=0,o=null,r=null,s=[],d=0,c={},u=!1,l=null,m=document.createElement("div");m.setAttribute("role","dialog"),m.setAttribute("aria-hidden","true"),m.classList.add("tobi-overlay"),document.getElementsByTagName("body")[0].appendChild(m);var b=document.createElement("div");b.classList.add("tobi-slider"),m.appendChild(b);var g=document.createElement("button");g.setAttribute("type","button"),g.setAttribute("aria-label","Previous"),m.appendChild(g);var p=document.createElement("button");p.setAttribute("type","button"),p.setAttribute("aria-label","Next"),m.appendChild(p);var f=document.createElement("button");f.setAttribute("type","button"),f.setAttribute("aria-label","Close"),m.appendChild(f);var v=document.createElement("div");v.classList.add("tobi-counter"),m.appendChild(v);var h={image:{checkSupport:function(t){return null!=t.href.match(/\.(png|jpg|tiff|tif|gif|bmp|webp|svg|ico)$/)},init:function(t,i){var n=document.createElement("img");if(n.style.opacity="0",t.getElementsByTagName("img")[0]&&t.getElementsByTagName("img")[0].alt?n.alt=t.getElementsByTagName("img")[0].alt:n.alt="",n.setAttribute("src",""),n.setAttribute("data-src",t.href),i.appendChild(n),i.setAttribute("data-type","image"),e.captions){var o=document.createElement("figcaption");o.style.opacity="0","self"===e.captionsSelector&&t.getAttribute(e.captionAttribute)?o.innerHTML=t.getAttribute(e.captionAttribute):"img"===e.captionsSelector&&t.getElementsByTagName("img")[0]&&t.getElementsByTagName("img")[0].getAttribute(e.captionAttribute)&&(o.innerHTML=t.getElementsByTagName("img")[0].getAttribute(e.captionAttribute)),o.innerHTML&&(o.id="tobi-figcaption-"+a,i.appendChild(o),n.setAttribute("aria-labelledby",o.id))}},onPreload:function(t){h.image.onLoad(t)},onLoad:function(t){var e=t.getElementsByTagName("img")[0];if(e.hasAttribute("data-src")){var i=t.getElementsByTagName("figcaption")[0],n=document.createElement("div");n.classList.add("tobi-loader"),t.appendChild(n),e.onload=function(){var n=t.querySelector(".tobi-loader");t.removeChild(n),e.style.opacity="1",i&&(i.style.opacity="1")},e.setAttribute("src",e.getAttribute("data-src")),e.removeAttribute("data-src")}},onLeave:function(t){}},youtube:{checkSupport:function(t){var e=M(t.href);return"www.youtube.com"===e},init:function(t,e){var i=document.createElement("iframe"),n=t.href;n.indexOf("?")===-1&&(n+="?param=false"),n+="&enablejsapi=1";var a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=1280;t.hasAttribute("data-width")&&(r=t.getAttribute("data-width")),r>a&&(r=a);var s=720;t.hasAttribute("data-height")&&(s=t.getAttribute("data-height")),s>o&&(s=o),i.setAttribute("width",r),i.setAttribute("height",s),i.setAttribute("frameborder","0"),i.setAttribute("allow","autoplay; encrypted-media"),i.setAttribute("allowfullscreen",""),i.style.opacity="0",i.setAttribute("src",""),i.setAttribute("data-src",n),e.appendChild(i),e.setAttribute("data-type","youtube")},onPreload:function(t){},onLoad:function(t){var e=t.getElementsByTagName("iframe")[0];e.style.opacity="1";var i=t.getElementsByTagName("figcaption")[0];i&&(i.style.opacity="1"),e.setAttribute("src",e.getAttribute("data-src"))},onLeave:function(t){var e=t.getElementsByTagName("iframe")[0];e.setAttribute("src","")}},iframe:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"iframe"!==t.getAttribute("data-type"))},init:function(t,e){var i=document.createElement("iframe"),n=t.href,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,r=1280;t.hasAttribute("data-width")&&(r=t.getAttribute("data-width")),r>a&&(r=a);var s=720;t.hasAttribute("data-height")&&(s=t.getAttribute("data-height")),s>o&&(s=o),i.setAttribute("width",r),i.setAttribute("height",s),i.setAttribute("frameborder","0"),i.style.opacity="0",i.setAttribute("src",""),i.setAttribute("data-src",n),e.appendChild(i),e.setAttribute("data-type","iframe")},onPreload:function(t){},onLoad:function(t){var e=t.getElementsByTagName("iframe")[0];e.style.opacity="1";var i=t.getElementsByTagName("figcaption")[0];i&&(i.style.opacity="1"),e.setAttribute("src",e.getAttribute("data-src"))},onLeave:function(t){var e=t.getElementsByTagName("iframe")[0];e.setAttribute("src","")}},html:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"html"!==t.getAttribute("data-type"))},init:function(t,e){var i=document.createElement("div");i.classList.add("tobi-html");var n=t.getAttribute("data-target"),a=document.querySelector(n);return null===a?void console.log("Ups, I can't find the target "+n+"."):(a.style.display="none",i.style.opacity="0",i.innerHTML=a.innerHTML,e.appendChild(i),void e.setAttribute("data-type","html"))},onPreload:function(t){},onLoad:function(t){var e=t.querySelector(".tobi-html");e.style.opacity="1";var i=t.getElementsByTagName("figcaption")[0];i&&(i.style.opacity="1")},onLeave:function(t){var e=t.querySelector("video");null!==e&&e.pause()}}},y=function(t){return e=x(t),i=B(),o=document.querySelectorAll(e.selector),(r=o.length)?void[].forEach.call(o,function(t){A(t)}):void console.log("Ups, I can't find the selector "+e.selector+".")},A=function(t){if(n.indexOf(t)===-1){if(n.push(t),t.classList.add("tobi"),e.zoom&&t.getElementsByTagName("img")[0]){var i=document.createElement("div");i.classList.add("tobi__zoom-icon"),i.innerHTML=e.zoomText,t.classList.add("tobi--zoom"),t.appendChild(i)}t.addEventListener("click",function(t){t.preventDefault(),L(n.indexOf(this))}),E(t)}},E=function(t){var i=null,n=null,o=null;i=document.createElement("div"),i.classList.add("tobi-slide"),n=document.createElement("div"),n.classList.add("tobi-figure-wrapper"),o=document.createElement("figure"),o.classList.add("tobi-figure");for(var d in h)if(h[d].checkSupport(t)===!0){h[d].init(t,o);break}n.appendChild(o),i.appendChild(n),b.appendChild(i),s.push(i),++a,!e.nav||1===r||"auto"===e.nav&&"ontouchstart"in window?(g.setAttribute("aria-hidden","true"),p.setAttribute("aria-hidden","true")):(g.setAttribute("aria-hidden","false"),p.setAttribute("aria-hidden","false"),g.innerHTML=e.navText[0],p.innerHTML=e.navText[1]),e.counter&&1!==r?v.setAttribute("aria-hidden","false"):v.setAttribute("aria-hidden","true"),e.close?f.innerHTML=e.closeText:f.setAttribute("aria-hidden","true"),e.draggable&&(b.style.cursor="-webkit-grab")},L=function(t){"false"!==m.getAttribute("aria-hidden")&&(e.scroll||(document.documentElement.classList.add("tobi--is-open"),document.body.classList.add("tobi--is-open")),l=document.activeElement,d=t,q(),G(),T(d),k(d+1),k(d-1),N(),H(),m.setAttribute("aria-hidden","false"),S())},w=function(){"true"!==m.getAttribute("aria-hidden")&&(e.scroll||(document.documentElement.classList.remove("tobi--is-open"),document.body.classList.remove("tobi--is-open")),J(),m.setAttribute("aria-hidden","true"),l.focus())},k=function(t,e,i){if(void 0!==s[t]){var n=s[t].querySelector("figure"),a=n.getAttribute("data-type");h[a].onPreload(n)}},T=function(t,e,i){if(void 0!==s[t]){var n=s[t].querySelector("figure"),a=n.getAttribute("data-type");h[a].onLoad(n)}},C=function(){for(var t=0;t<s.length;t++){var e=s[t].querySelector("figure"),i=e.getAttribute("data-type");h[i].onLeave(e)}},x=function(t){var e={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6" /></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6" /></svg>'],close:!0,closeText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" /></svg>',counter:!0,keyboard:!0,zoom:!0,zoomText:"&plus;",docClose:!0,swipeClose:!0,scroll:!1,draggable:!0,threshold:20};return t&&Object.keys(t).forEach(function(i){e[i]=t[i]}),e},B=function(){var t=document.documentElement.style;return"string"==typeof t.transform?"transform":"WebkitTransform"},N=function(){var t=100*-d+"%";b.style[i]="translate3d("+t+", 0, 0)"},H=function(){v.innerHTML=d+1+"/"+r},S=function(t){e.nav?(g.disabled=!1,p.disabled=!1,d===r-1?p.disabled=!0:0===d&&(g.disabled=!0),t||p.disabled?t||!p.disabled||g.disabled?p.disabled||"right"!==t?p.disabled&&"right"===t&&!g.disabled?g.focus():g.disabled||"left"!==t?g.disabled&&"left"===t&&!p.disabled&&p.focus():g.focus():p.focus():g.focus():p.focus()):e.close&&f.focus()},X=function(){d!==s.length-1&&C(),d<r-1&&(d++,N(),H(),S("right"),T(d),k(d+1))},P=function(){d>0&&C(),d>0&&(d--,N(),H(),S("left"),T(d),k(d-1))},M=function(t){var e;return e=t.indexOf("//")>-1?t.split("/")[2]:t.split("/")[0],e=e.split(":")[0],e=e.split("?")[0]},q=function(){c={startX:0,endX:0,startY:0,endY:0}},Y=function(){var t=c.endX-c.startX,i=c.endY-c.startY,n=Math.abs(t),a=Math.abs(i);t>0&&n>e.threshold?P():t<0&&n>e.threshold?X():i<0&&a>e.threshold&&e.swipeClose&&w()},j=function(t){t.target===g?P():t.target===p?X():(t.target===f||t.target.classList.contains("tobi-figure-wrapper")&&!t.target.classList.contains("tobi-figure"))&&w(),t.stopPropagation()},W=function(t){switch(t.keyCode){case 37:P();break;case 39:X();break;case 27:w()}},z=function(t){t.stopPropagation(),u=!0,c.startX=t.touches[0].pageX,c.startY=t.touches[0].pageY},O=function(t){t.preventDefault(),t.stopPropagation(),u&&(c.endX=t.touches[0].pageX,c.endY=t.touches[0].pageY)},D=function(t){t.stopPropagation(),u=!1,c.endX&&Y(),q()},I=function(t){t.preventDefault(),t.stopPropagation(),u=!0,c.startX=t.pageX,b.style.cursor="-webkit-grabbing"},U=function(t){t.stopPropagation(),u=!1,b.style.cursor="-webkit-grab",c.endX&&Y(),q()},_=function(t){t.preventDefault(),u&&(c.endX=t.pageX,b.style.cursor="-webkit-grabbing")},$=function(t){u&&(u=!1,b.style.cursor="-webkit-grab",c.endX=t.pageX,Y(),q())},F=function(t){"false"!==m.getAttribute("aria-hidden")||m.contains(t.target)||(t.stopPropagation(),S())},G=function(){e.keyboard&&document.addEventListener("keydown",W),e.docClose&&m.addEventListener("click",j),g.addEventListener("click",j),p.addEventListener("click",j),f.addEventListener("click",j),e.draggable&&(m.addEventListener("touchstart",z),m.addEventListener("touchmove",O),m.addEventListener("touchend",D),m.addEventListener("mousedown",I),m.addEventListener("mouseup",U),m.addEventListener("mouseleave",$),m.addEventListener("mousemove",_)),document.addEventListener("focus",F,!0)},J=function(){e.keyboard&&document.removeEventListener("keydown",W),e.docClose&&m.removeEventListener("click",j),g.removeEventListener("click",j),p.removeEventListener("click",j),f.removeEventListener("click",j),e.draggable&&(m.removeEventListener("touchstart",z),m.removeEventListener("touchmove",O),m.removeEventListener("touchend",D),m.removeEventListener("mousedown",I),m.removeEventListener("mouseup",U),m.removeEventListener("mouseleave",$),m.removeEventListener("mousemove",_)),document.removeEventListener("focus",F),C()},K=function(t){A(t),r++};return y(t),{prev:P,next:X,open:L,close:w,add:K}};return t});