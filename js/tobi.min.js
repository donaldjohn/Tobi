(function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t():e.Tobi=t()})(this,function(){var e=function(e){"use strict";var t=function(e){var t={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:["&lsaquo;","&rsaquo;"],close:!0,closeText:"&times;",counter:!0,keyboard:!0,zoom:!0,zoomText:"&plus;",docClose:!1,swipeClose:!0,scroll:!1,draggable:!0,threshold:20};return e&&Object.keys(e).forEach(function(n){t[n]=e[n]}),t},n={},i=null,o=[],a=null,r=[],s=0,d={},c=!1,l=null,u=document.createElement("div");u.setAttribute("role","dialog"),u.setAttribute("aria-hidden","true"),u.classList.add("tobi-overlay"),document.getElementsByTagName("body")[0].appendChild(u);var m=document.createElement("div");m.classList.add("tobi-slider"),u.appendChild(m);var b=document.createElement("button");b.setAttribute("type","button"),b.setAttribute("aria-label","Previous"),u.appendChild(b);var p=document.createElement("button");p.setAttribute("type","button"),p.setAttribute("aria-label","Next"),u.appendChild(p);var f=document.createElement("button");f.setAttribute("type","button"),f.setAttribute("aria-label","Close"),u.appendChild(f);var v=document.createElement("div");v.classList.add("tobi-counter"),u.appendChild(v);var g=function(){var e=document.documentElement.style;return"string"==typeof e.transform?"transform":"WebkitTransform"},h=function(e,t){if("undefined"!=typeof o[e]&&"undefined"!=typeof r[e]){if(!r[e].getElementsByTagName("img")[0].hasAttribute("data-src"))return void(t&&t());var n=r[e].getElementsByTagName("figure")[0],i=n.getElementsByTagName("img")[0],a=n.getElementsByTagName("figcaption")[0];i.onload=function(){var e=n.querySelector(".tobi-loader");n.removeChild(e),i.style.opacity="1",a&&(a.style.opacity="1")},i.setAttribute("src",i.getAttribute("data-src")),i.removeAttribute("data-src"),t&&t()}},E=function(){var e=100*-s+"%";m.style[i]="translate3d("+e+", 0, 0)"},y=function(){v.innerHTML=s+1+"/"+a},L=function(e){n.nav?(b.disabled=!1,p.disabled=!1,s===a-1?p.disabled=!0:0===s&&(b.disabled=!0),"none"!==e||p.disabled?"none"===e&&p.disabled&&!b.disabled?b.focus():p.disabled||"right"!==e?p.disabled&&"right"===e&&!b.disabled?b.focus():b.disabled||"left"!==e?b.disabled&&"left"===e&&!p.disabled&&p.focus():b.focus():p.focus():p.focus()):n.close&&f.focus()},A=function(e){h(e)},T=function(){s<a-1&&(s++,E(),y(),L("right"),A(s+1))},k=function(){s>0&&(s--,E(),y(),L("left"),A(s-1))},C=function(){for(var e=0,t=0,i=null,s=null,d=null,c=[],l=null,g=[];e<a;++e)r[e]=document.createElement("div"),r[e].classList.add("tobi-slide"),r[e].id="tobi-slide-"+e,i=document.createElement("div"),i.classList.add("tobi-figure-wrapper"),i.id="tobi-figure-wrapper-"+e,s=document.createElement("figure"),s.innerHTML='<div class="tobi-loader"></div>',d=document.createElement("img"),d.style.opacity="0",o[e].selector.getElementsByTagName("img")[0]&&o[e].selector.getElementsByTagName("img")[0].alt?d.alt=o[e].selector.getElementsByTagName("img")[0].alt:d.alt="",d.setAttribute("src",""),d.setAttribute("data-src",o[e].selector.href),s.appendChild(d),n.captions&&(l=document.createElement("figcaption"),l.style.opacity="0","self"===n.captionsSelector&&o[e].selector.getAttribute(n.captionAttribute)?l.innerHTML=o[e].selector.getAttribute(n.captionAttribute):"img"===n.captionsSelector&&o[e].selector.getElementsByTagName("img")[0].getAttribute(n.captionAttribute)&&(l.innerHTML=o[e].selector.getElementsByTagName("img")[0].getAttribute(n.captionAttribute)),l.innerHTML&&(s.id="tobi-figure-"+t,l.id="tobi-figcaption-"+t,s.appendChild(l),c.push("tobi-figure-"+t),g.push("tobi-figcaption-"+t),++t)),i.appendChild(s),r[e].appendChild(i),m.appendChild(r[e]);0!==t&&(u.setAttribute("aria-labelledby",c.join(" ")),u.setAttribute("aria-describedby",g.join(" "))),!n.nav||1===a||"auto"===n.nav&&"ontouchstart"in window?(b.style.display="none",p.style.display="none"):(b.innerHTML=n.navText[0],p.innerHTML=n.navText[1]),n.counter&&1!==a||(v.style.display="none"),n.close?f.innerHTML=n.closeText:f.style.display="none",n.draggable&&(m.style.cursor="-webkit-grab")},w=function(e){"false"!==u.getAttribute("aria-hidden")&&(n.scroll||(document.documentElement.classList.add("tobi--is-open"),document.body.classList.add("tobi--is-open")),l=document.activeElement,s=e,x(),O(),h(s,function(){A(s+1),A(s-1)}),E(),y(),u.setAttribute("aria-hidden","false"),L("none"))},X=function(){"true"!==u.getAttribute("aria-hidden")&&(n.scroll||(document.documentElement.classList.remove("tobi--is-open"),document.body.classList.remove("tobi--is-open")),_(),u.setAttribute("aria-hidden","true"),l.focus())},x=function(){d={startX:0,endX:0,startY:0,endY:0}},N=function(){var e=d.endX-d.startX,t=d.endY-d.startY,i=Math.abs(e),o=Math.abs(t);e>0&&i>n.threshold?k():e<0&&i>n.threshold?T():t<0&&o>n.threshold&&n.swipeClose&&X()},B=function(e){this===b?k():this===p?T():(this===f||this===u&&e.target.id.indexOf("tobi-figure-wrapper")!==-1)&&X(),e.preventDefault()},M=function(e){switch(e.keyCode){case 37:k();break;case 39:T();break;case 27:X()}},H=function(e){e.stopPropagation(),c=!0,d.startX=e.touches[0].pageX,d.startY=e.touches[0].pageY},Y=function(e){e.preventDefault(),e.stopPropagation(),c&&(d.endX=e.touches[0].pageX,d.endY=e.touches[0].pageY)},P=function(e){e.stopPropagation(),c=!1,d.endX&&N(),x()},z=function(e){e.preventDefault(),e.stopPropagation(),c=!0,d.startX=e.pageX},D=function(e){e.stopPropagation(),c=!1,m.style.cursor="-webkit-grab",d.endX&&N(),x()},S=function(e){e.preventDefault(),c&&(d.endX=e.pageX,m.style.cursor="-webkit-grabbing")},j=function(e){c&&(c=!1,m.style.cursor="-webkit-grab",d.endX=e.pageX,N(),x())},q=function(e){"false"!==u.getAttribute("aria-hidden")||u.contains(e.target)||(e.stopPropagation(),L("none"))},O=function(){n.keyboard&&document.addEventListener("keydown",M),n.docClose&&u.addEventListener("click",B),b.addEventListener("click",B),p.addEventListener("click",B),f.addEventListener("click",B),n.draggable&&(u.addEventListener("touchstart",H),u.addEventListener("touchmove",Y),u.addEventListener("touchend",P),u.addEventListener("mousedown",z),u.addEventListener("mouseup",D),u.addEventListener("mouseleave",j),u.addEventListener("mousemove",S)),document.addEventListener("focus",q,!0)},_=function(){n.keyboard&&document.removeEventListener("keydown",M),n.docClose&&u.removeEventListener("click",B),b.removeEventListener("click",B),p.removeEventListener("click",B),f.removeEventListener("click",B),n.draggable&&(u.removeEventListener("touchstart",H),u.removeEventListener("touchmove",Y),u.removeEventListener("touchend",P),u.removeEventListener("mousedown",z),u.removeEventListener("mouseup",D),u.removeEventListener("mouseleave",j),u.removeEventListener("mousemove",S)),document.removeEventListener("focus",q)},I=function(e){n=t(e),i=g();var r=document.querySelectorAll(n.selector);if(!r.length)throw new Error("Ups, I can't find the selector "+n.selector+".");[].forEach.call(r,function(e,t){if(e.classList.add("tobi"),n.zoom&&e.getElementsByTagName("img")[0]){var i=document.createElement("div");i.classList.add("tobi__zoom-icon"),i.innerHTML=n.zoomText,e.classList.add("tobi--zoom"),e.appendChild(i)}e.addEventListener("click",function(e){e.preventDefault(),w(t)}),o.push({selector:e})}),a=o.length,C()};I(e)};return e});
