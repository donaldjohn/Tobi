(function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t():e.Tobi=t()})(this,function(){"use strict";var e=function(e){var t={},n=window,i=null,o=[],a=0,r=0,d=null,l=null,u=[],s=null,c=null,p=null,b=null,f=0,m={},h=!1,v=!1,g=!1,y=null,A=null,w=null,E=null,L=null,_=!1,C=!1,S=!1,x=!1,k=[],T=[],q=0,P=0,N=function(e){var t={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg role="img" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24"><polyline points="14 18 8 12 14 6 14 6"></polyline></svg>','<svg role="img" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24"><polyline points="10 6 16 12 10 18 10 18"></polyline></svg>'],navLabel:["Previous","Next"],close:!0,closeText:'<svg role="img" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewbox="0 0 24 24"><path d="M6.34314575 6.34314575L17.6568542 17.6568542M6.34314575 17.6568542L17.6568542 6.34314575"></path></svg>',closeLabel:"Close",loadingIndicatorLabel:"Image loading",counter:!0,download:!1,downloadText:"",downloadLabel:"Download",keyboard:!0,zoom:!0,zoomText:'<svg role="img" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><polyline points="21 16 21 21 16 21"/><polyline points="8 21 3 21 3 16"/><polyline points="16 3 21 3 21 8"/><polyline points="3 8 3 3 8 3"/></svg>',docClose:!0,swipeClose:!0,hideScrollbar:!0,draggable:!0,threshold:100,rtl:!1,loop:!1,autoplayVideo:!1,theme:"dark"};return e&&Object.keys(e).forEach(function(n){t[n]=e[n]}),t},X=function(){return"string"==typeof document.documentElement.style.transform?"transform":"WebkitTransform"},Y={image:{checkSupport:function(e){return!e.hasAttribute("data-type")&&e.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)$/)},init:function(e,n){var i=document.createElement("figure"),o=document.createElement("figcaption"),r=document.createElement("img"),d=e.querySelector("img"),l=document.createElement("div");r.style.opacity="0",d&&(r.alt=d.alt||""),r.setAttribute("src",""),r.setAttribute("data-src",e.href),i.appendChild(r),t.captions&&(o.style.opacity="0","self"===t.captionsSelector&&e.getAttribute(t.captionAttribute)?o.textContent=e.getAttribute(t.captionAttribute):"img"===t.captionsSelector&&d&&d.getAttribute(t.captionAttribute)&&(o.textContent=d.getAttribute(t.captionAttribute)),o.textContent&&(o.id="tobi-figcaption-"+a,i.appendChild(o),r.setAttribute("aria-labelledby",o.id),++a)),n.appendChild(i),l.className="tobi-loader",l.setAttribute("role","progressbar"),l.setAttribute("aria-label",t.loadingIndicatorLabel),n.appendChild(l),n.setAttribute("data-type","image")},onPreload:function(e){Y.image.onLoad(e)},onLoad:function(e){var t=e.querySelector("img");if(t.hasAttribute("data-src")){var n=e.querySelector("figcaption"),i=e.querySelector(".tobi-loader");t.onload=function(){e.removeChild(i),t.style.opacity="1",n&&(n.style.opacity="1")},t.setAttribute("src",t.getAttribute("data-src")),t.removeAttribute("data-src")}},onLeave:function(e){},onCleanup:function(e){}},html:{checkSupport:function(e){return se(e,"html")},init:function(e,t){var n=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target"),i=document.querySelector(n);if(!i)throw new Error("Ups, I can't find the target "+n+".");t.appendChild(i),t.setAttribute("data-type","html")},onPreload:function(e){},onLoad:function(e){var n=e.querySelector("video");n&&(n.hasAttribute("data-time")&&n.readyState>0&&(n.currentTime=n.getAttribute("data-time")),t.autoplayVideo&&n.play())},onLeave:function(e){var t=e.querySelector("video");t&&(t.paused||t.pause(),t.readyState>0&&t.setAttribute("data-time",t.currentTime))},onCleanup:function(e){var t=e.querySelector("video");if(t&&t.readyState>0&&t.readyState<3&&t.duration!==t.currentTime){var n=t.cloneNode(!0);ce(t),t.load(),t.parentNode.removeChild(t),e.appendChild(n)}}},iframe:{checkSupport:function(e){return se(e,"iframe")},init:function(e,t){var n=document.createElement("iframe"),i=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target");n.setAttribute("frameborder","0"),n.setAttribute("src",""),n.setAttribute("data-src",i),t.appendChild(n),t.setAttribute("data-type","iframe")},onPreload:function(e){},onLoad:function(e){var t=e.querySelector("iframe");t.setAttribute("src",t.getAttribute("data-src"))},onLeave:function(e){},onCleanup:function(e){}},youtube:{checkSupport:function(e){return se(e,"youtube")},init:function(e,t){var n=document.createElement("div");t.appendChild(n),T[q]=new window.YT.Player(n,{host:"https://www.youtube-nocookie.com",height:e.getAttribute("data-height")||"360",width:e.getAttribute("data-width")||"640",videoId:e.getAttribute("data-id"),playerVars:{controls:e.getAttribute("data-controls")||1,rel:0,playsinline:1}}),t.setAttribute("data-player",q),t.setAttribute("data-type","youtube"),q++},onPreload:function(e){},onLoad:function(e){t.autoplayVideo&&T[e.getAttribute("data-player")].playVideo()},onLeave:function(e){1===T[e.getAttribute("data-player")].getPlayerState()&&T[e.getAttribute("data-player")].pauseVideo()},onCleanup:function(e){1===T[e.getAttribute("data-player")].getPlayerState()&&T[e.getAttribute("data-player")].pauseVideo()}}},I=function(e){t=N(e),i=X(),d||O();var n=document.querySelectorAll(t.selector);if(!n)throw new Error("Ups, I can't find the selector "+t.selector+".");Array.prototype.forEach.call(n,function(e){M(e)})},M=function(e){if(null===document.querySelector('[data-type="youtube"]')||x)D(e);else{if(null===document.getElementById("iframe_api")){var t=document.createElement("script"),n=document.getElementsByTagName("script")[0];t.id="iframe_api",t.src="https://www.youtube.com/iframe_api",n.parentNode.insertBefore(t,n)}k.indexOf(e)===-1&&k.push(e),window.onYouTubePlayerAPIReady=function(){Array.prototype.forEach.call(k,function(e){D(e)}),x=!0}}},D=function(e,n){if(o.indexOf(e)!==-1)throw new Error("Ups, element already added to the lightbox.");if(o.push(e),r++,t.zoom&&e.querySelector("img")){var i=document.createElement("div");i.className="tobi-zoom__icon",i.innerHTML=t.zoomText,e.classList.add("tobi-zoom"),e.appendChild(i)}e.addEventListener("click",function(e){e.preventDefault(),z(o.indexOf(this))}),V(e),fe()&&pe(),n&&n.call(this)},O=function(){d=document.createElement("div"),d.setAttribute("role","dialog"),d.setAttribute("aria-hidden","true"),d.className="tobi tobi--theme-"+t.theme,l=document.createElement("div"),l.className="tobi__slider",d.appendChild(l),s=document.createElement("button"),s.className="tobi__prev",s.setAttribute("type","button"),s.setAttribute("aria-label",t.navLabel[0]),s.innerHTML=t.navText[0],d.appendChild(s),c=document.createElement("button"),c.className="tobi__next",c.setAttribute("type","button"),c.setAttribute("aria-label",t.navLabel[1]),c.innerHTML=t.navText[1],d.appendChild(c),p=document.createElement("button"),p.className="tobi__close",p.setAttribute("type","button"),p.setAttribute("aria-label",t.closeLabel),p.innerHTML=t.closeText,d.appendChild(p),b=document.createElement("div"),b.className="tobi__counter",d.appendChild(b),n.addEventListener("resize",function(){_||(_=!0,n.requestAnimationFrame(function(){K(),_=!1}))}),document.body.appendChild(d)},V=function(e){for(var n in Y)if(Y.hasOwnProperty(n)&&Y[n].checkSupport(e)){var i=document.createElement("div"),o=document.createElement("div");i.className="tobi__slider__slide",i.style.position="absolute",i.style.left=100*P+"%",o.className="tobi__slider__slide__content",t.draggable&&o.classList.add("draggable"),Y[n].init(e,o),i.appendChild(o),l.appendChild(i),u.push(i),++P;break}},z=function(e,n){if(fe()||e||(e=0),fe()){if(!e)throw new Error("Ups, Tobi is aleady open.");if(e===f)throw new Error("Ups, slide "+e+" is already selected.")}if(e===-1||e>=r)throw new Error("Ups, I can't find slide "+e+".");t.hideScrollbar&&(document.documentElement.classList.add("tobi-is-open"),document.body.classList.add("tobi-is-open")),!t.nav||1===r||"auto"===t.nav&&me()?(s.setAttribute("aria-hidden","true"),c.setAttribute("aria-hidden","true")):(s.setAttribute("aria-hidden","false"),c.setAttribute("aria-hidden","false")),t.counter&&1!==r?b.setAttribute("aria-hidden","false"):b.setAttribute("aria-hidden","true"),t.close||(p.disabled=!1,p.setAttribute("aria-hidden","true")),y=document.activeElement,f=e,J(),le(),H(f),d.setAttribute("aria-hidden","false"),pe(),B(f+1),B(f-1),n&&n.call(this)},U=function(e){if(!fe())throw new Error("Tobi is already closed.");t.hideScrollbar&&(document.documentElement.classList.remove("tobi-is-open"),document.body.classList.remove("tobi-is-open")),ue(),y.focus();var n=u[f].querySelector(".tobi__slider__slide__content"),i=n.getAttribute("data-type");Y[i].onLeave(n),Y[i].onCleanup(n),d.setAttribute("aria-hidden","true"),f=0,e&&e.call(this)},B=function(e){if(void 0!==u[e]){var t=u[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");Y[n].onPreload(t)}},H=function(e){if(void 0!==u[e]){var t=u[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");Y[n].onLoad(t)}},j=function(e){f>0&&(R(f),H(--f),pe("left"),W(f+1),B(f-1),e&&e.call(this))},F=function(e){f<r-1&&(R(f),H(++f),pe("right"),W(f-1),B(f+1),e&&e.call(this))},R=function(e){if(void 0!==u[e]){var t=u[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");Y[n].onLeave(t)}},W=function(e){if(void 0!==u[e]){var t=u[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");Y[n].onCleanup(t)}},K=function(){E=-f*window.innerWidth,l.style[i]="translate3d("+E+"px, 0, 0)",L=E},$=function(){b.textContent=f+1+"/"+r},G=function(e){var n=null;t.nav?(s.disabled=!1,c.disabled=!1,1===r?(s.disabled=!0,c.disabled=!0,t.close&&p.focus()):0===f?s.disabled=!0:f===r-1&&(c.disabled=!0),e||c.disabled?e||!c.disabled||s.disabled?c.disabled||"right"!==e?c.disabled&&"right"===e&&!s.disabled?s.focus():s.disabled||"left"!==e?s.disabled&&"left"===e&&!c.disabled&&c.focus():s.focus():c.focus():s.focus():c.focus()):t.close&&p.focus(),n=d.querySelectorAll("button:not(:disabled)"),A=n[0],w=1===n.length?n[0]:n[n.length-1]},J=function(){m={startX:0,endX:0,startY:0,endY:0}},Q=function(){var e=m.endX-m.startX,n=m.endY-m.startY,i=Math.abs(e),o=Math.abs(n);e>0&&i>t.threshold&&f>0?j():e<0&&i>t.threshold&&f!==r-1?F():n<0&&o>t.threshold&&t.swipeClose?U():K()},Z=function(e){e.target===s?j():e.target===c?F():e.target!==p&&"tobi__slider__slide"!==e.target.className||U(),e.stopPropagation()},ee=function(e){9===e.keyCode?e.shiftKey?document.activeElement===A&&(w.focus(),e.preventDefault()):document.activeElement===w&&(A.focus(),e.preventDefault()):27===e.keyCode?(e.preventDefault(),U()):37===e.keyCode?(e.preventDefault(),j()):39===e.keyCode&&(e.preventDefault(),F())},te=function(e){he(e.target)||(e.stopPropagation(),g=!0,m.startX=e.touches[0].pageX,m.startY=e.touches[0].pageY)},ne=function(e){e.stopPropagation(),g&&(e.preventDefault(),m.endX=e.touches[0].pageX,m.endY=e.touches[0].pageY,C||(C=!0,n.requestAnimationFrame(function(){de(),C=!1})))},ie=function(e){e.stopPropagation(),g=!1,m.endX&&(h=!1,v=!1,Q()),J()},oe=function(e){he(e.target)||(e.preventDefault(),e.stopPropagation(),g=!0,m.startX=e.pageX,m.startY=e.pageY)},ae=function(e){e.preventDefault(),g&&(m.endX=e.pageX,m.endY=e.pageY,S||(S=!0,n.requestAnimationFrame(function(){de(),S=!1})))},re=function(e){e.stopPropagation(),g=!1,m.endX&&(h=!1,v=!1,Q()),J()},de=function(){Math.abs(m.startX-m.endX)>0&&!v&&t.swipeClose?(l.style[i]="translate3d("+(L-Math.round(m.startX-m.endX))+"px, 0, 0)",h=!0,v=!1):Math.abs(m.startY-m.endY)>0&&!h&&(l.style[i]="translate3d("+(L+"px, -"+Math.round(m.startY-m.endY))+"px, 0)",h=!1,v=!0)},le=function(){t.keyboard&&document.addEventListener("keydown",ee),t.docClose&&d.addEventListener("click",Z),s.addEventListener("click",Z),c.addEventListener("click",Z),p.addEventListener("click",Z),t.draggable&&(me()&&(d.addEventListener("touchstart",te),d.addEventListener("touchmove",ne),d.addEventListener("touchend",ie)),d.addEventListener("mousedown",oe),d.addEventListener("mouseup",re),d.addEventListener("mousemove",ae))},ue=function(){t.keyboard&&document.removeEventListener("keydown",ee),t.docClose&&d.removeEventListener("click",Z),s.removeEventListener("click",Z),c.removeEventListener("click",Z),p.removeEventListener("click",Z),t.draggable&&(me()&&(d.addEventListener("touchstart",te),d.addEventListener("touchmove",ne),d.addEventListener("touchend",ie)),d.removeEventListener("touchstart",te),d.removeEventListener("touchmove",ne),d.removeEventListener("touchend",ie),d.removeEventListener("mousedown",oe),d.removeEventListener("mouseup",re),d.removeEventListener("mousemove",ae))},se=function(e,t){return e.getAttribute("data-type")===t},ce=function(e){var t=e.querySelectorAll("src");t&&Array.prototype.forEach.call(t,function(e){e.setAttribute("src","")})},pe=function(e){K(),$(),G(e)},be=function(e){if(l)for(;l.firstChild;)l.removeChild(l.firstChild);o.length=u.length=r=a=P=0,e&&e.call(this)},fe=function(){return"false"===d.getAttribute("aria-hidden")},me=function(){return"ontouchstart"in window},he=function(e){return["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(e.nodeName)!==-1},ve=function(){return f};return I(e),{open:z,prev:j,next:F,close:U,add:M,reset:be,isOpen:fe,currentSlide:ve}};return e});