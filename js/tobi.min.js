(function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof module&&module.exports?module.exports=e():t.Tobi=e()})(this,function(){"use strict";var t=function(t){var e={},n=null,i=[],o=0,r=null,a=null,s=[],d=0,u={},c=!1,l=null,f=null,m=document.createElement("div");m.setAttribute("role","dialog"),m.setAttribute("aria-hidden","true"),m.classList.add("tobi-overlay"),document.getElementsByTagName("body")[0].appendChild(m);var p=document.createElement("div");p.classList.add("tobi-slider"),m.appendChild(p);var b=document.createElement("button");b.setAttribute("type","button"),b.setAttribute("aria-label","Previous"),m.appendChild(b);var g=document.createElement("button");g.setAttribute("type","button"),g.setAttribute("aria-label","Next"),m.appendChild(g);var v=document.createElement("button");v.setAttribute("type","button"),v.setAttribute("aria-label","Close"),m.appendChild(v);var h=document.createElement("div");h.classList.add("tobi-counter"),m.appendChild(h);var y={image:{checkSupport:function(t){return null!=t.href.match(/\.(png|jpg|tiff|tif|gif|bmp|webp|svg|ico)$/)},init:function(t,n){var i=document.createElement("img");if(i.style.opacity="0",t.getElementsByTagName("img")[0]&&t.getElementsByTagName("img")[0].alt?i.alt=t.getElementsByTagName("img")[0].alt:i.alt="",i.setAttribute("src",""),i.setAttribute("data-src",t.href),n.appendChild(i),n.setAttribute("data-type","image"),e.captions){var r=document.createElement("figcaption");r.style.opacity="0","self"===e.captionsSelector&&t.getAttribute(e.captionAttribute)?r.innerHTML=t.getAttribute(e.captionAttribute):"img"===e.captionsSelector&&t.getElementsByTagName("img")[0]&&t.getElementsByTagName("img")[0].getAttribute(e.captionAttribute)&&(r.innerHTML=t.getElementsByTagName("img")[0].getAttribute(e.captionAttribute)),r.innerHTML&&(r.id="tobi-figcaption-"+o,n.appendChild(r),i.setAttribute("aria-labelledby",r.id))}},onPreload:function(t){y.image.onLoad(t)},onLoad:function(t){var e=t.getElementsByTagName("img")[0];if(e.hasAttribute("data-src")){var n=t.getElementsByTagName("figcaption")[0],i=document.createElement("div");i.classList.add("tobi-loader"),t.appendChild(i),e.onload=function(){var i=t.querySelector(".tobi-loader");t.removeChild(i),e.style.opacity="1",n&&(n.style.opacity="1")},e.setAttribute("src",e.getAttribute("data-src")),e.removeAttribute("data-src")}},onLeave:function(t){}},youtube:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"youtube"!==t.getAttribute("data-type"))},init:function(t,e){},onPreload:function(t){},onLoad:function(t){},onLeave:function(t){}},iframe:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"iframe"!==t.getAttribute("data-type"))},init:function(t,e){var n=document.createElement("iframe"),i=t.href;n.setAttribute("frameborder","0"),n.setAttribute("src",""),n.setAttribute("data-src",i),e.appendChild(n),e.setAttribute("data-type","iframe")},onPreload:function(t){},onLoad:function(t){var e=t.getElementsByTagName("iframe")[0];e.setAttribute("src",e.getAttribute("data-src"))},onLeave:function(t){}},html:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"html"!==t.getAttribute("data-type"))},init:function(t,e){var n=document.createElement("div");n.classList.add("tobi-html");var i=t.getAttribute("data-target"),o=document.querySelector(i);return null===o?void console.log("Ups, I can't find the target "+i+"."):(n.innerHTML=o.innerHTML,o.style.display="none",e.appendChild(n),void e.setAttribute("data-type","html"))},onPreload:function(t){},onLoad:function(t){},onLeave:function(t){var e=t.querySelector("video");null!==e&&e.pause()}}},L=function(t){return e=X(t),n=B(),r=document.querySelectorAll(e.selector),(a=r.length)?void[].forEach.call(r,function(t){A(t)}):void console.log("Ups, I can't find the selector "+e.selector+".")},A=function(t){if(i.indexOf(t)===-1){if(i.push(t),t.classList.add("tobi"),e.zoom&&t.getElementsByTagName("img")[0]){var n=document.createElement("div");n.classList.add("tobi__zoom-icon"),n.innerHTML=e.zoomText,t.classList.add("tobi--zoom"),t.appendChild(n)}t.addEventListener("click",function(t){t.preventDefault(),w(i.indexOf(this))}),E(t)}},E=function(t){var n=null,i=null,r=null;n=document.createElement("div"),n.classList.add("tobi-slide"),i=document.createElement("div"),i.classList.add("tobi-figure-wrapper"),r=document.createElement("figure"),r.classList.add("tobi-figure");for(var d in y)if(y[d].checkSupport(t)===!0){y[d].init(t,r);break}i.appendChild(r),n.appendChild(i),p.appendChild(n),s.push(n),++o,!e.nav||1===a||"auto"===e.nav&&"ontouchstart"in window?(b.setAttribute("aria-hidden","true"),g.setAttribute("aria-hidden","true")):(b.setAttribute("aria-hidden","false"),g.setAttribute("aria-hidden","false"),b.innerHTML=e.navText[0],g.innerHTML=e.navText[1]),e.counter&&1!==a?h.setAttribute("aria-hidden","false"):h.setAttribute("aria-hidden","true"),e.close?v.innerHTML=e.closeText:v.setAttribute("aria-hidden","true"),e.draggable&&(p.style.cursor="-webkit-grab")},w=function(t){"false"!==m.getAttribute("aria-hidden")&&(e.scroll||(document.documentElement.classList.add("tobi--is-open"),document.body.classList.add("tobi--is-open")),t||(t=0),l=document.activeElement,d=t,Y(),F(),T(d),x(d+1),x(d-1),S(),M(),m.setAttribute("aria-hidden","false"),P())},k=function(){"true"!==m.getAttribute("aria-hidden")&&(e.scroll||(document.documentElement.classList.remove("tobi--is-open"),document.body.classList.remove("tobi--is-open")),G(),C(),m.setAttribute("aria-hidden","true"),l.focus())},x=function(t){if(void 0!==s[t]){var e=s[t].querySelector("figure"),n=e.getAttribute("data-type");y[n].onPreload(e)}},T=function(t){if(void 0!==s[t]){var e=s[t].querySelector("figure"),n=e.getAttribute("data-type");y[n].onLoad(e)}},C=function(){for(var t=0;t<a;t++){var e=s[t].querySelector("figure"),n=e.getAttribute("data-type");y[n].onLeave(e)}},X=function(t){var e={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6" /></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6" /></svg>'],close:!0,closeText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" /></svg>',counter:!0,keyboard:!0,zoom:!0,zoomText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" /></svg>',docClose:!0,swipeClose:!0,scroll:!1,draggable:!0,threshold:20};return t&&Object.keys(t).forEach(function(n){e[n]=t[n]}),e},B=function(){var t=document.documentElement.style;return"string"==typeof t.transform?"transform":"WebkitTransform"},S=function(){f=-d*window.innerWidth,p.style[n]="translate3d("+f+"px, 0, 0)",p.setAttribute("data-offset",f)},M=function(){h.innerHTML=d+1+"/"+a},P=function(t){e.nav?(b.disabled=!1,g.disabled=!1,d===a-1?g.disabled=!0:0===d&&(b.disabled=!0),t||g.disabled?t||!g.disabled||b.disabled?g.disabled||"right"!==t?g.disabled&&"right"===t&&!b.disabled?b.focus():b.disabled||"left"!==t?b.disabled&&"left"===t&&!g.disabled&&g.focus():b.focus():g.focus():b.focus():g.focus()):e.close&&v.focus()},N=function(){d!==a-1&&C(),d<a-1&&(d++,S(),M(),P("right"),T(d),x(d+1))},H=function(){d>0&&C(),d>0&&(d--,S(),M(),P("left"),T(d),x(d-1))},Y=function(){u={startX:0,endX:0,startY:0,endY:0}},j=function(){var t=u.endX-u.startX,i=u.endY-u.startY,o=Math.abs(t),r=Math.abs(i);t>0&&o>e.threshold&&d>0?H():t<0&&o>e.threshold&&d!==a-1?N():i<0&&r>e.threshold&&e.swipeClose?k():(f=p.getAttribute("data-offset"),p.style[n]="translate3d("+f+"px, 0, 0)")},q=function(t){t.target===b?H():t.target===g?N():(t.target===v||t.target.classList.contains("tobi-figure-wrapper")&&!t.target.classList.contains("tobi-figure"))&&k(),t.stopPropagation()},z=function(t){switch(t.keyCode){case 37:H();break;case 39:N();break;case 27:k()}},D=function(t){t.stopPropagation(),c=!0,u.startX=t.touches[0].pageX,u.startY=t.touches[0].pageY},O=function(t){t.preventDefault(),t.stopPropagation(),c&&(u.endX=t.touches[0].pageX,u.endY=t.touches[0].pageY,f=p.getAttribute("data-offset"),p.style[n]="translate3d("+(f-Math.round(u.startX-u.endX))+"px, 0, 0)")},I=function(t){t.stopPropagation(),c=!1,u.endX&&j(),Y()},U=function(t){t.preventDefault(),t.stopPropagation(),c=!0,u.startX=t.pageX,p.style.cursor="-webkit-grabbing"},W=function(t){t.stopPropagation(),c=!1,p.style.cursor="-webkit-grab",u.endX&&j(),Y()},_=function(t){t.preventDefault(),c&&(u.endX=t.pageX,p.style.cursor="-webkit-grabbing",f=p.getAttribute("data-offset"),p.style[n]="translate3d("+(f-Math.round(u.startX-u.endX))+"px, 0, 0)")},$=function(t){"false"!==m.getAttribute("aria-hidden")||m.contains(t.target)||(t.stopPropagation(),P())},F=function(){e.keyboard&&document.addEventListener("keydown",z),e.docClose&&m.addEventListener("click",q),b.addEventListener("click",q),g.addEventListener("click",q),v.addEventListener("click",q),e.draggable&&(m.addEventListener("touchstart",D),m.addEventListener("touchmove",O),m.addEventListener("touchend",I),m.addEventListener("mousedown",U),m.addEventListener("mouseup",W),m.addEventListener("mousemove",_)),document.addEventListener("focus",$,!0)},G=function(){e.keyboard&&document.removeEventListener("keydown",z),e.docClose&&m.removeEventListener("click",q),b.removeEventListener("click",q),g.removeEventListener("click",q),v.removeEventListener("click",q),e.draggable&&(m.removeEventListener("touchstart",D),m.removeEventListener("touchmove",O),m.removeEventListener("touchend",I),m.removeEventListener("mousedown",U),m.removeEventListener("mouseup",W),m.removeEventListener("mousemove",_)),document.removeEventListener("focus",$)},J=function(t){A(t),a++};return L(t),{prev:H,next:N,open:w,close:k,add:J}};return t});