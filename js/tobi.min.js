(function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof module&&module.exports?module.exports=t():e.Tobi=t()})(this,function(){"use strict";var e=function(e){var t={},n=window,o=null,i=[],r=0,a=0,d=null,s=null,l=[],u=null,c=null,p=null,f=null,b=0,v={},m=!1,h=null,g=null,y=null,A=null,_=null,L=!1,E=0,w=function(e){var t={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:['<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6" /></svg>','<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6" /></svg>'],navLabel:["Previous","Next"],close:!0,closeText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18" /><line x1="6" y1="6" x2="18" y2="18" /></svg>',closeLabel:"Close",counter:!0,download:!1,downloadText:"",downloadLabel:"Download",keyboard:!0,zoom:!0,zoomText:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" ><line x1="12" y1="5" x2="12" y2="19" /><line x1="5" y1="12" x2="19" y2="12" /></svg>',docClose:!0,swipeClose:!0,scroll:!1,draggable:!0,threshold:100,autoplayVideo:!1};return e&&Object.keys(e).forEach(function(n){t[n]=e[n]}),t},C=function(){return"string"==typeof document.documentElement.style.transform?"transform":"WebkitTransform"},k={image:{checkSupport:function(e){return!e.hasAttribute("data-type")&&e.href.match(/\.(png|jpe?g|tiff|tif|gif|bmp|webp|svg|ico)$/)},init:function(e,n){var o=document.createElement("figure"),i=document.createElement("figcaption"),a=document.createElement("img"),d=e.querySelector("img"),s=document.createElement("div");a.style.opacity="0",d&&(a.alt=d.alt||""),a.setAttribute("src",""),a.setAttribute("data-src",e.href),o.appendChild(a),t.captions&&(i.style.opacity="0","self"===t.captionsSelector&&e.getAttribute(t.captionAttribute)?i.textContent=e.getAttribute(t.captionAttribute):"img"===t.captionsSelector&&d&&d.getAttribute(t.captionAttribute)&&(i.textContent=d.getAttribute(t.captionAttribute)),i.textContent&&(i.id="tobi-figcaption-"+r,o.appendChild(i),a.setAttribute("aria-labelledby",i.id),++r)),n.appendChild(o),s.className="tobi-loader",n.appendChild(s),n.setAttribute("data-type","image")},onPreload:function(e){k.image.onLoad(e)},onLoad:function(e){var t=e.querySelector("img");if(t.hasAttribute("data-src")){var n=e.querySelector("figcaption"),o=e.querySelector(".tobi-loader");t.onload=function(){e.removeChild(o),t.style.opacity="1",n&&(n.style.opacity="1")},t.setAttribute("src",t.getAttribute("data-src")),t.removeAttribute("data-src")}},onLeave:function(e){},onCleanup:function(e){}},youtube:{checkSupport:function(e){return ee(e,"youtube")},init:function(e,t){},onPreload:function(e){},onLoad:function(e){},onLeave:function(e){},onCleanup:function(e){}},iframe:{checkSupport:function(e){return ee(e,"iframe")},init:function(e,t){var n=document.createElement("iframe"),o=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target");n.setAttribute("frameborder","0"),n.setAttribute("src",""),n.setAttribute("data-src",o),t.appendChild(n),t.setAttribute("data-type","iframe")},onPreload:function(e){},onLoad:function(e){var t=e.querySelector("iframe");t.setAttribute("src",t.getAttribute("data-src"))},onLeave:function(e){},onCleanup:function(e){}},html:{checkSupport:function(e){return ee(e,"html")},init:function(e,t){var n=e.hasAttribute("href")?e.getAttribute("href"):e.getAttribute("data-target"),o=document.querySelector(n);return o?(t.appendChild(o),void t.setAttribute("data-type","html")):console.log("Ups, I can't find the target "+n+".")},onPreload:function(e){},onLoad:function(e){var n=e.querySelector("video");n&&(n.hasAttribute("data-time")&&(n.currentTime=n.getAttribute("data-time")),n.hasAttribute("data-src")&&(n.src=n.getAttribute("data-src"),n.removeAttribute("data-src")),t.autoplayVideo&&n.play())},onLeave:function(e){var t=e.querySelector("video");t&&(t.paused||t.pause(),t.setAttribute("data-time",t.currentTime))},onCleanup:function(e){var t=e.querySelector("video");t&&t.readyState>0&&t.readyState<4&&(t.setAttribute("data-src",t.src),t.removeAttribute("src"),t.load())}}},x=function(e){t=w(e),o=C();var n=document.querySelectorAll(t.selector);return n?void Array.prototype.forEach.call(n,function(e){S(e)}):console.log("Ups, I can't find the selector "+t.selector+".")},S=function(e){if(d||q(),i.indexOf(e)===-1){if(i.push(e),a++,t.zoom&&e.querySelector("img")){var n=document.createElement("div");n.className="tobi-zoom__icon",n.innerHTML=t.zoomText,e.classList.add("tobi-zoom"),e.appendChild(n)}e.addEventListener("click",function(e){e.preventDefault(),X(i.indexOf(this))}),T(e),ie()&&te()}else console.log("Element already added to the lightbox.")},q=function(){d=document.createElement("div"),d.setAttribute("role","dialog"),d.setAttribute("aria-hidden","true"),d.className="tobi",s=document.createElement("div"),s.className="tobi__slider",d.appendChild(s),u=document.createElement("button"),u.className="tobi__prev",u.setAttribute("type","button"),u.setAttribute("aria-label",t.navLabel[0]),u.innerHTML=t.navText[0],d.appendChild(u),c=document.createElement("button"),c.className="tobi__next",c.setAttribute("type","button"),c.setAttribute("aria-label",t.navLabel[1]),c.innerHTML=t.navText[1],d.appendChild(c),p=document.createElement("button"),p.className="tobi__close",p.setAttribute("type","button"),p.setAttribute("aria-label",t.closeLabel),p.innerHTML=t.closeText,d.appendChild(p),f=document.createElement("div"),f.className="tobi__counter",d.appendChild(f),n.addEventListener("resize",function(){L||(L=!0,n.requestAnimationFrame(function(){O(),L=!1}))}),document.body.appendChild(d)},T=function(e){for(var n in k)if(k.hasOwnProperty(n)&&k[n].checkSupport(e)){var o=document.createElement("div"),i=document.createElement("div");o.className="tobi__slider__slide",o.style.position="absolute",o.style.left=100*E+"%",i.className="tobi__slider__slide__content",t.draggable&&i.classList.add("draggable"),k[n].init(e,i),o.appendChild(i),s.appendChild(o),l.push(o),++E;break}},X=function(e){if(ie()||e||(e=0),ie()){if(!e)return console.log("Ups, Tobi is aleady open.");if(e===b)return console.log("Ups, slide "+e+" is already selected.")}return e===-1||e>=a?console.log("Ups, I can't find slide "+e+"."):(t.scroll||(document.documentElement.classList.add("tobi-is-open"),document.body.classList.add("tobi-is-open")),!t.nav||1===a||"auto"===t.nav&&"ontouchstart"in window?(u.setAttribute("aria-hidden","true"),c.setAttribute("aria-hidden","true")):(u.setAttribute("aria-hidden","false"),c.setAttribute("aria-hidden","false")),t.counter&&1!==a?f.setAttribute("aria-hidden","false"):f.setAttribute("aria-hidden","true"),t.close||(p.disabled=!1,p.setAttribute("aria-hidden","true")),h=document.activeElement,b=e,H(),R(),Y(b),d.setAttribute("aria-hidden","false"),te(),N(b+1),void N(b-1))},P=function(){if(!ie())return console.log("Tobi is already closed.");t.scroll||(document.documentElement.classList.remove("tobi-is-open"),document.body.classList.remove("tobi-is-open")),Z(),h.focus();var e=l[b].querySelector(".tobi__slider__slide__content"),n=e.getAttribute("data-type");k[n].onLeave(e),k[n].onCleanup(e),d.setAttribute("aria-hidden","true")},N=function(e){if(void 0!==l[e]){var t=l[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");k[n].onPreload(t)}},Y=function(e){if(void 0!==l[e]){var t=l[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");k[n].onLoad(t)}},D=function(){b<a-1&&(j(b),Y(++b),te("right"),z(b-1),N(b+1))},M=function(){b>0&&(j(b),Y(--b),te("left"),z(b+1),N(b-1))},j=function(e){if(void 0!==l[e]){var t=l[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");k[n].onLeave(t)}},z=function(e){if(void 0!==l[e]){var t=l[e].querySelector(".tobi__slider__slide__content"),n=t.getAttribute("data-type");k[n].onCleanup(t)}},O=function(){A=-b*window.innerWidth,s.style[o]="translate3d("+A+"px, 0, 0)",_=A},U=function(){f.textContent=b+1+"/"+a},B=function(e){var n=null;t.nav?(u.disabled=!1,c.disabled=!1,1===a?(u.disabled=!0,c.disabled=!0,t.close&&p.focus()):0===b?u.disabled=!0:b===a-1&&(c.disabled=!0),e||c.disabled?e||!c.disabled||u.disabled?c.disabled||"right"!==e?c.disabled&&"right"===e&&!u.disabled?u.focus():u.disabled||"left"!==e?u.disabled&&"left"===e&&!c.disabled&&c.focus():u.focus():c.focus():u.focus():c.focus()):t.close&&p.focus(),n=d.querySelectorAll("button:not(:disabled)"),g=n[0],y=1===n.length?n[0]:n[n.length-1]},H=function(){v={startX:0,endX:0,startY:0,endY:0}},I=function(){var e=v.endX-v.startX,n=v.endY-v.startY,o=Math.abs(e),i=Math.abs(n);e>0&&o>t.threshold&&b>0?M():e<0&&o>t.threshold&&b!==a-1?D():n<0&&i>t.threshold&&t.swipeClose?P():O()},V=function(e){e.target===u?M():e.target===c?D():e.target!==p&&"tobi__slider__slide"!==e.target.className||P(),e.stopPropagation()},W=function(e){9===e.keyCode?e.shiftKey?document.activeElement===g&&(y.focus(),e.preventDefault()):document.activeElement===y&&(g.focus(),e.preventDefault()):27===e.keyCode?(e.preventDefault(),P()):37===e.keyCode?(e.preventDefault(),M()):39===e.keyCode&&(e.preventDefault(),D())},F=function(e){e.stopPropagation(),m=!0,v.startX=e.touches[0].pageX,v.startY=e.touches[0].pageY},K=function(e){e.preventDefault(),e.stopPropagation(),m&&(v.endX=e.touches[0].pageX,v.endY=e.touches[0].pageY,s.style[o]="translate3d("+(_-Math.round(v.startX-v.endX))+"px, 0, 0)")},$=function(e){e.stopPropagation(),m=!1,v.endX&&I(),H()},G=function(e){e.preventDefault(),e.stopPropagation(),m=!0,v.startX=e.pageX,v.startY=e.pageY},J=function(e){e.preventDefault(),m&&(v.endX=e.pageX,v.endY=e.pageY,s.style[o]="translate3d("+(_-Math.round(v.startX-v.endX))+"px, 0, 0)")},Q=function(e){e.stopPropagation(),m=!1,v.endX&&I(),H()},R=function(){t.keyboard&&document.addEventListener("keydown",W),t.docClose&&d.addEventListener("click",V),u.addEventListener("click",V),c.addEventListener("click",V),p.addEventListener("click",V),t.draggable&&(d.addEventListener("touchstart",F),d.addEventListener("touchmove",K),d.addEventListener("touchend",$),d.addEventListener("mousedown",G),d.addEventListener("mouseup",Q),d.addEventListener("mousemove",J))},Z=function(){t.keyboard&&document.removeEventListener("keydown",W),t.docClose&&d.removeEventListener("click",V),u.removeEventListener("click",V),c.removeEventListener("click",V),p.removeEventListener("click",V),t.draggable&&(d.removeEventListener("touchstart",F),d.removeEventListener("touchmove",K),d.removeEventListener("touchend",$),d.removeEventListener("mousedown",G),d.removeEventListener("mouseup",Q),d.removeEventListener("mousemove",J))},ee=function(e,t){return e.getAttribute("data-type")===t},te=function(e){O(),U(),B(e)},ne=function(e){S(e)},oe=function(){if(s)for(;s.firstChild;)s.removeChild(s.firstChild);i.length=l.length=a=r=E=0},ie=function(){return"false"===d.getAttribute("aria-hidden")};return x(e),{open:X,prev:M,next:D,close:P,add:ne,reset:oe,isOpen:ie,version:"1.7.2"}};return e});
