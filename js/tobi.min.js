!function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof module&&module.exports?module.exports=e():t.Tobi=e()}(this,function(){"use strict";return function(t){var r={},e=null,i=[],o=0,n=null,s=null,d=[],a=0,c={},u=!1,l=null,m=document.createElement("div");m.setAttribute("role","dialog"),m.setAttribute("aria-hidden","true"),m.classList.add("tobi-overlay"),document.getElementsByTagName("body")[0].appendChild(m);var b=document.createElement("div");b.classList.add("tobi-slider"),m.appendChild(b);var g=document.createElement("button");g.setAttribute("type","button"),g.setAttribute("aria-label","Previous"),m.appendChild(g);var p=document.createElement("button");p.setAttribute("type","button"),p.setAttribute("aria-label","Next"),m.appendChild(p);var f=document.createElement("button");f.setAttribute("type","button"),f.setAttribute("aria-label","Close"),m.appendChild(f);var h=document.createElement("div");h.classList.add("tobi-counter"),m.appendChild(h);var v={image:{checkSupport:function(t){return null!=t.href.match(/\.(png|jpg|tiff|tif|gif|bmp|webp|svg|ico)$/)},init:function(t,e){var i=document.createElement("img");if(i.style.opacity="0",t.getElementsByTagName("img")[0]&&t.getElementsByTagName("img")[0].alt?i.alt=t.getElementsByTagName("img")[0].alt:i.alt="",i.setAttribute("src",""),i.setAttribute("data-src",t.href),e.appendChild(i),e.setAttribute("data-type","image"),r.captions){var n=document.createElement("figcaption");n.style.opacity="0","self"===r.captionsSelector&&t.getAttribute(r.captionAttribute)?n.innerHTML=t.getAttribute(r.captionAttribute):"img"===r.captionsSelector&&t.getElementsByTagName("img")[0]&&t.getElementsByTagName("img")[0].getAttribute(r.captionAttribute)&&(n.innerHTML=t.getElementsByTagName("img")[0].getAttribute(r.captionAttribute)),n.innerHTML&&(n.id="tobi-figcaption-"+o,e.appendChild(n),i.setAttribute("aria-labelledby",n.id))}},onPreload:function(t){v.image.onLoad(t)},onLoad:function(e){var i=e.getElementsByTagName("img")[0];if(i.hasAttribute("data-src")){var n=e.getElementsByTagName("figcaption")[0],t=document.createElement("div");t.classList.add("tobi-loader"),e.appendChild(t),i.onload=function(){var t=e.querySelector(".tobi-loader");e.removeChild(t),i.style.opacity="1",n&&(n.style.opacity="1")},i.setAttribute("src",i.getAttribute("data-src")),i.removeAttribute("data-src")}},onLeave:function(t){}},youtube:{checkSupport:function(t){return"www.youtube.com"==X(t.href)},init:function(t,e){var i=document.createElement("iframe"),n=t.href;-1===n.indexOf("?")&&(n+="?param=false"),n+="&enablejsapi=1";var a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=1280;t.hasAttribute("data-width")&&(o=t.getAttribute("data-width")),a<o&&(o=a);var s=720;t.hasAttribute("data-height")&&(s=t.getAttribute("data-height")),r<s&&(s=r),i.setAttribute("width",o),i.setAttribute("height",s),i.setAttribute("frameborder","0"),i.setAttribute("allow","autoplay; encrypted-media"),i.setAttribute("allowfullscreen",""),i.style.opacity="0",i.setAttribute("src",""),i.setAttribute("data-src",n),e.appendChild(i),e.setAttribute("data-type","youtube")},onPreload:function(t){},onLoad:function(t){var e=t.getElementsByTagName("iframe")[0];e.style.opacity="1";var i=t.getElementsByTagName("figcaption")[0];i&&(i.style.opacity="1"),e.setAttribute("src",e.getAttribute("data-src"))},onLeave:function(t){t.getElementsByTagName("iframe")[0].setAttribute("src","")}},iframe:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"iframe"!=t.getAttribute("data-type"))},init:function(t,e){var i=document.createElement("iframe"),n=t.href,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,o=1280;t.hasAttribute("data-width")&&(o=t.getAttribute("data-width")),a<o&&(o=a);var s=720;t.hasAttribute("data-height")&&(s=t.getAttribute("data-height")),r<s&&(s=r),i.setAttribute("width",o),i.setAttribute("height",s),i.setAttribute("frameborder","0"),i.style.opacity="0",i.setAttribute("src",""),i.setAttribute("data-src",n),e.appendChild(i),e.setAttribute("data-type","iframe")},onPreload:function(t){},onLoad:function(t){var e=t.getElementsByTagName("iframe")[0];e.style.opacity="1";var i=t.getElementsByTagName("figcaption")[0];i&&(i.style.opacity="1"),e.setAttribute("src",e.getAttribute("data-src"))},onLeave:function(t){t.getElementsByTagName("iframe")[0].setAttribute("src","")}},html:{checkSupport:function(t){return!(!t.hasAttribute("data-type")||"html"!=t.getAttribute("data-type"))},init:function(t,e){var i=document.createElement("div");i.classList.add("tobi-html");var n=t.getAttribute("data-target"),a=document.querySelector(n);null!=a?(i.style.opacity="0",i.innerHTML=a.innerHTML,e.appendChild(i),e.setAttribute("data-type","html")):console.log("Can not find target: "+n)},onPreload:function(t){},onLoad:function(t){t.querySelector(".tobi-html").style.opacity="1";var e=t.getElementsByTagName("figcaption")[0];e&&(e.style.opacity="1")},onLeave:function(t){var e=t.querySelector("video");null!=e&&e.pause()}}},y=function(t){if(-1===i.indexOf(t)){if(i.push(t),t.classList.add("tobi"),r.zoom&&t.getElementsByTagName("img")[0]){var e=document.createElement("div");e.classList.add("tobi__zoom-icon"),e.innerHTML=r.zoomText,t.classList.add("tobi--zoom"),t.appendChild(e)}t.addEventListener("click",function(t){t.preventDefault(),E(i.indexOf(this))}),A(t)}},A=function(t){var e=null,i=null,n=null;for(var a in(e=document.createElement("div")).classList.add("tobi-slide"),(i=document.createElement("div")).classList.add("tobi-figure-wrapper"),(n=document.createElement("figure")).classList.add("tobi-figure"),v)if(1==v[a].checkSupport(t)){v[a].init(t,n);break}i.appendChild(n),e.appendChild(i),b.appendChild(e),d.push(e),++o,!r.nav||1===s||"auto"===r.nav&&"ontouchstart"in window?(g.setAttribute("aria-hidden","true"),p.setAttribute("aria-hidden","true")):(g.setAttribute("aria-hidden","false"),p.setAttribute("aria-hidden","false"),g.innerHTML=r.navText[0],p.innerHTML=r.navText[1]),r.counter&&1!==s?h.setAttribute("aria-hidden","false"):h.setAttribute("aria-hidden","true"),r.close?f.innerHTML=r.closeText:f.setAttribute("aria-hidden","true"),r.draggable&&(b.style.cursor="-webkit-grab")},E=function(t){"false"!==m.getAttribute("aria-hidden")&&(r.scroll||(document.documentElement.classList.add("tobi--is-open"),document.body.classList.add("tobi--is-open")),l=document.activeElement,a=t,P(),$(),T(a),w(a+1),w(a-1),N(),B(),m.setAttribute("aria-hidden","false"),x())},L=function(){"true"!==m.getAttribute("aria-hidden")&&(r.scroll||(document.documentElement.classList.remove("tobi--is-open"),document.body.classList.remove("tobi--is-open")),F(),m.setAttribute("aria-hidden","true"),l.focus())},w=function(t,e,i){if(null!=d[t]){var n=d[t].querySelector("figure"),a=n.getAttribute("data-type");v[a].onPreload(n)}},T=function(t,e,i){if(null!=d[t]){var n=d[t].querySelector("figure"),a=n.getAttribute("data-type");v[a].onLoad(n)}},k=function(){for(var t=0;t<d.length;t++){var e=d[t].querySelector("figure"),i=e.getAttribute("data-type");v[i].onLeave(e)}},C=function(){return"string"==typeof document.documentElement.style.transform?"transform":"WebkitTransform"},N=function(){var t=100*-a+"%";b.style[e]="translate3d("+t+", 0, 0)"},B=function(){h.innerHTML=a+1+"/"+s},x=function(t){r.nav?(g.disabled=!1,p.disabled=!1,a===s-1?p.disabled=!0:0===a&&(g.disabled=!0),t||p.disabled?t||!p.disabled||g.disabled?p.disabled||"right"!==t?p.disabled&&"right"===t&&!g.disabled?g.focus():g.disabled||"left"!==t?g.disabled&&"left"===t&&!p.disabled&&p.focus():g.focus():p.focus():g.focus():p.focus()):r.close&&f.focus()},H=function(){a!=d.length-1&&k(),a<s-1&&(a++,N(),B(),x("right"),T(a),w(a+1))},S=function(){0<a&&k(),0<a&&(a--,N(),B(),x("left"),T(a),w(a-1))},X=function(t){return(-1<t.indexOf("//")?t.split("/")[2]:t.split("/")[0]).split(":")[0].split("?")[0]},P=function(){c={startX:0,endX:0,startY:0,endY:0}},M=function(){var t=c.endX-c.startX,e=c.endY-c.startY,i=Math.abs(t),n=Math.abs(e);0<t&&i>r.threshold?S():t<0&&i>r.threshold?H():e<0&&n>r.threshold&&r.swipeClose&&L()},q=function(t){t.target===g?S():t.target===p?H():(t.target===f||t.target.classList.contains("tobi-figure-wrapper")&&!t.target.classList.contains("tobi-figure"))&&L(),t.stopPropagation()},Y=function(t){switch(t.keyCode){case 37:S();break;case 39:H();break;case 27:L()}},W=function(t){t.stopPropagation(),u=!0,c.startX=t.touches[0].pageX,c.startY=t.touches[0].pageY},z=function(t){t.preventDefault(),t.stopPropagation(),u&&(c.endX=t.touches[0].pageX,c.endY=t.touches[0].pageY)},O=function(t){t.stopPropagation(),u=!1,c.endX&&M(),P()},j=function(t){t.preventDefault(),t.stopPropagation(),u=!0,c.startX=t.pageX,b.style.cursor="-webkit-grabbing"},D=function(t){t.stopPropagation(),u=!1,b.style.cursor="-webkit-grab",c.endX&&M(),P()},_=function(t){t.preventDefault(),u&&(c.endX=t.pageX,b.style.cursor="-webkit-grabbing")},I=function(t){u&&(u=!1,b.style.cursor="-webkit-grab",c.endX=t.pageX,M(),P())},U=function(t){"false"!==m.getAttribute("aria-hidden")||m.contains(t.target)||(t.stopPropagation(),x())},$=function(){r.keyboard&&document.addEventListener("keydown",Y),r.docClose&&m.addEventListener("click",q),g.addEventListener("click",q),p.addEventListener("click",q),f.addEventListener("click",q),r.draggable&&(m.addEventListener("touchstart",W),m.addEventListener("touchmove",z),m.addEventListener("touchend",O),m.addEventListener("mousedown",j),m.addEventListener("mouseup",D),m.addEventListener("mouseleave",I),m.addEventListener("mousemove",_)),document.addEventListener("focus",U,!0)},F=function(){r.keyboard&&document.removeEventListener("keydown",Y),r.docClose&&m.removeEventListener("click",q),g.removeEventListener("click",q),p.removeEventListener("click",q),f.removeEventListener("click",q),r.draggable&&(m.removeEventListener("touchstart",W),m.removeEventListener("touchmove",z),m.removeEventListener("touchend",O),m.removeEventListener("mousedown",j),m.removeEventListener("mouseup",D),m.removeEventListener("mouseleave",I),m.removeEventListener("mousemove",_)),document.removeEventListener("focus",U),k()};return G=t,J={selector:".lightbox",captions:!0,captionsSelector:"img",captionAttribute:"alt",nav:"auto",navText:["&lsaquo;","&rsaquo;"],close:!0,closeText:"&times;",counter:!0,keyboard:!0,zoom:!0,zoomText:"&plus;",docClose:!0,swipeClose:!0,scroll:!1,draggable:!0,threshold:20},G&&Object.keys(G).forEach(function(t){J[t]=G[t]}),r=J,e=C(),n=document.querySelectorAll(r.selector),(s=n.length)?[].forEach.call(n,function(t){y(t)}):console.log("Ups, I can't find the selector "+r.selector+"."),{prev:S,next:H,open:E,close:L,add:function(t){y(t),s++}};var G,J}});